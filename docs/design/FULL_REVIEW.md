**Findings**
- High: Constraint Jacobian updates are skipped on rejected steps for in-place solvers, so DAE rows are dropped when recomputing the Jacobian, which can destabilize or mis-solve constrained steps. (`/Users/fillmore/EarthSystem/MICM-DAE/include/micm/solver/rosenbrock.inl:200`)
- High: SolverBuilder silently ignores non-EquilibriumConstraint types when cloning constraints, which can drop constraints without warning and leave the system underconstrained. (`/Users/fillmore/EarthSystem/MICM-DAE/include/micm/solver/solver_builder.inl:438`)
- Medium: Error scaling for constraint variables uses species-only tolerances via modulo indexing, so algebraic variables get arbitrary tolerances and can dominate or be ignored in step-size control. (`/Users/fillmore/EarthSystem/MICM-DAE/include/micm/solver/rosenbrock.inl:300`, `/Users/fillmore/EarthSystem/MICM-DAE/include/micm/solver/solver_builder.inl:493`)
- Medium: ConstraintSet Jacobian updates assume precomputed flat IDs and a non-vectorized sparse layout; calling `SubtractJacobianTerms` before `SetJacobianFlatIds` or using vectorized ordering can index invalid/misplaced entries. (`/Users/fillmore/EarthSystem/MICM-DAE/include/micm/constraint/constraint_set.hpp:238`, `/Users/fillmore/EarthSystem/MICM-DAE/include/micm/util/sparse_matrix_vector_ordering_compressed_sparse_row.hpp:52`)
- Medium: EquilibriumConstraint only validates K_eq and permits empty reactant/product lists or non-positive stoichiometries, which can yield meaningless constraints or NaNs. (`/Users/fillmore/EarthSystem/MICM-DAE/include/micm/constraint/equilibrium_constraint.hpp:53`)
- Medium: Constraint bookkeeping is fragile: `SetConstraintCount`/`SetConstraintNames` can diverge from `SetConstraints`, and constraint names can collide with species names, overwriting indices in the variable map. (`/Users/fillmore/EarthSystem/MICM-DAE/include/micm/solver/solver_builder.inl:406`, `/Users/fillmore/EarthSystem/MICM-DAE/include/micm/solver/solver_builder.inl:423`)

**Questions / Assumptions**
- Should algebraic variables have dedicated absolute tolerances or be excluded from error control rather than reusing species tolerances?
- Is the projection step in the DAE integration test expected long-term, or should the solver enforce constraints internally? (`/Users/fillmore/EarthSystem/MICM-DAE/test/integration/test_equilibrium.cpp:512`)
- Should `SetConstraintCount` be allowed without `SetConstraints`, or should this be rejected to avoid unconstrained algebraic variables?
- Are constraints intended to work with vectorized matrix policies, or should this be blocked/documented until a vectorized ConstraintSet implementation exists?

**PR Part 1 Notes**
- Input validation + typed constraint errors were added for empty reactants/products and invalid stoichiometry. (`/Users/fillmore/EarthSystem/MICM/include/micm/constraint/equilibrium_constraint.hpp:64`)
- Constraint/ConstraintSet now use pointer-based Residual/Jacobian with precomputed dependency offsets to avoid per-cell allocations. (`/Users/fillmore/EarthSystem/MICM/include/micm/constraint/constraint_set.hpp:118`)
- Unit tests now cover empty reactants/products and invalid stoichiometries, closing gaps from the full DAE branch. (`/Users/fillmore/EarthSystem/MICM/test/unit/constraint/test_constraint.cpp`)
- The same `SetJacobianFlatIds` precondition still exists; consider adding an explicit guard/assert for direct API usage. (`/Users/fillmore/EarthSystem/MICM/include/micm/constraint/constraint_set.hpp:231`)

**Change Summary**
- Reviewed the full DAE implementation in MICM-DAE (constraints, solver integration, and tests).
- Compared those behaviors with the split PR part 1 changes in MICM.
- Main risks sit in solver integration for constraints (reject-step Jacobians, constraint cloning, and error control).
- Part 1 already improves validation and allocation behavior but does not yet carry solver-level DAE support.

Meta
- Original unit tests generated by Claude Opus 4.5 Max.
- PR is split into 3 parts; this review covers the full DAE implementation (pre-split) with notes on part 1.
- Review authored by Codex 5.2 (High).
- Extra High addendum authored by Codex 5.2 (XHigh).

Extra High Review Addendum
- Extra High pass focused on solver correctness and DAE stability; comments at this level cover: rejected-step Jacobian recomputation for constraints, constraint cloning/drop behavior in `SolverBuilder`, error scaling for algebraic variables, ConstraintSet flat-ID/vectorized indexing hazards, constraint bookkeeping/name collisions, and the projection-step assumption in the DAE integration test.
